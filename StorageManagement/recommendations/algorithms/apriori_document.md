حتماً، در ادامه یک فایل Markdown به زبان فارسی برای مستندسازی الگوریتم Apriori آورده شده است:

---

### 📄 مستندات الگوریتم Apriori

**مسیر فایل**: `recommendations/apriori_algorithm.py`
**هدف**: استخراج الگوهای پرتکرار خرید و تولید قوانین وابستگی بین محصولات با استفاده از الگوریتم Apriori.

---

## 🧠 معرفی کلی

الگوریتم Apriori یکی از رایج‌ترین روش‌ها برای **کاوش الگوهای پرتکرار** و **یادگیری قوانین وابستگی** است. این الگوریتم معمولاً در تحلیل سبد خرید مشتری استفاده می‌شود تا روابط میان محصولات خریداری‌شده را کشف کند.

در این پیاده‌سازی:

* داده‌های سفارش از فایل CSV بارگذاری می‌شوند.
* الگوریتم Apriori برای یافتن مجموعه‌های پرتکرار اجرا می‌شود.
* قوانین وابستگی با توجه به حداقل اطمینان و پشتیبانی تولید می‌شوند.
* نتایج در پایگاه‌داده ذخیره می‌شوند.

---

## ⚙️ تنظیمات

* **فایل داده ورودی**: `recommendations/data/order_items_data.csv`
* **آستانه حداقل پشتیبانی (Support)**: حداقل ۱٪ از کل تراکنش‌ها
* **حداقل اطمینان (Confidence)**: `0.5` (یعنی ۵۰٪)
* **حداکثر اندازه مجموعه اقلام (max\_k)**: `3`

---

## 🧩 توابع کلیدی

| تابع                          | توضیح                                                                           |
| ----------------------------- | ------------------------------------------------------------------------------- |
| `generateCandidate`           | تولید مجموعه‌های اقلام کاندید kتایی با استفاده از ترکیب مجموعه‌های پرتکرار قبلی |
| `calculateItemsetSupport`     | محاسبه تعداد تکرار هر مجموعه اقلام در تراکنش‌ها                                 |
| `removeItemset`               | حذف مجموعه‌هایی که از آستانه پشتیبانی پایین‌تر هستند                            |
| `calculateLift`               | محاسبه ضریب لیفت برای ارزیابی قدرت قوانین وابستگی                               |
| `generateAssociationRules`    | استخراج قوانین وابستگی از مجموعه‌های اقلام پرتکرار                              |
| `apriori`                     | اجرای کامل الگوریتم Apriori با کنترل مراحل بالا                                 |
| `extract_frequent_patterns`   | اجرای فرآیند کلی استخراج الگو و ذخیره آن در پایگاه داده                         |
| `get_product_recommendations` | دریافت پیشنهاد محصول براساس قوانین وابستگی                                      |
| `test_apriori`                | تابع تستی برای اجرای الگوریتم و نمایش نتایج اولیه                               |

---

## 🗃️ مدل‌های پایگاه‌داده

* **`Product`**: مدل محصول
* **`AssociationRule`**: مدل ذخیره قوانین وابستگی به همراه مقادیر اطمینان، پشتیبانی و لیفت
* **`RuleProduct`**: مدل ارتباط محصول با قوانین (با مشخص‌کردن نقش آن به‌عنوان پیش‌شرط یا نتیجه)

---

## 🛠️ فرآیند اجرا

1. **ایجاد تراکنش‌ها**
   سفارش‌ها براساس شناسه `order_id` گروه‌بندی شده و لیست محصولات هر سفارش تشکیل می‌شود.

2. **استخراج مجموعه‌های پرتکرار**

   * ابتدا مجموعه‌های تک‌عنصری ایجاد می‌شوند.
   * سپس به‌صورت تکراری، مجموعه‌های دوتایی، سه‌تایی و ... تولید شده و بررسی می‌شوند.

3. **تولید قوانین وابستگی**
   از میان مجموعه‌های پرتکرار، تمام ترکیب‌های ممکن پیش‌شرط و نتیجه تولید شده و قوانینی با اطمینان و لیفت قابل قبول انتخاب می‌شوند.

4. **ذخیره در پایگاه داده**
   قوانین استخراج‌شده به همراه محصولات متناظر در مدل‌های تعریف‌شده در پایگاه‌داده ذخیره می‌گردند.

---

## 📦 نمونه استفاده

برای اجرای تست و دریافت نتایج اولیه کافی است فایل را به‌صورت مستقیم اجرا کنید:

```bash
python recommendations/apriori_algorithm.py
```

---

## 📌 نکات

* داده‌های ورودی باید در قالب `order_id` و `product_name` باشند.
* اگر تعداد تراکنش‌ها کم باشد، ممکن است الگوریتم مجموعه پرتکرار کافی برای تولید قانون نداشته باشد.
* می‌توان این الگوریتم را به‌صورت دوره‌ای (مثلاً شبانه) اجرا کرد تا قوانین جدید بر اساس داده‌های به‌روز تولید شوند.

---

